<!Doctype html>
<html lang="en">

<head>
  <!-- Required meta tags -->
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <link rel="stylesheet" type="text/css" href="./node_modules/bootstrap/dist/css/bootstrap-grid.min.css">
  <link rel="stylesheet" type="text/css" href="login.css">
  <title>Login</title>
</head>

<body>
  <h1 style="text-align: center;">Welcome</h1>
  <form action="#" onsubmit="redirectPage(this)">
    <!--action="user_page.html"-->
    <div class="imgcontainer">
      <img src="Avatar.png" alt="Avatar" class="avatar">
    </div>

    <div class="container">
      <label for="uname"><b>Username</b></label>
      <input type="text" id="user-name" placeholder="Enter Username" name="uname" required>

      <label for="psw"><b>Password</b></label>
      <input type="password" id="user-pw" placeholder="Enter Password" name="psw" required>

      <label for="alert-message" id="alert-message"><b></b></label>

      <button type="submit" onclick="checkUserId(),checkUserPw()">Login</button>
      <label>
        <input type="checkbox" checked="checked" name="remember"> Remember me
      </label>
    </div>

    <div class="container" style="background-color:#bdbdbd">
      <button type="button" class="cancelbtn">Cancel</button>
      <span class="psw">Forgot <a href="#">password?</a></span>
    </div>
  </form>

</body>
<script type="text/javascript" src="./node_modules/bootstrap/dist/js/bootstrap.bundle.min.js"></script>


<script>

  const validUserData = {
    'jennie': { name: 'Jennie Ng', pw: 'abc' },
    'samuel': { name: 'Samuel Yeung', pw: '123' }
  }

  let isCorrectId = false;
  let isCorrectPw = false;
  let getUserId = '';
  let getUserPw = '';

  const checkUserId = () => {
    getUserId = document.getElementById("user-name").value;   //get userID input

    if (getUserId !== '') {                           //check user input not empty
      if (validUserData.hasOwnProperty(getUserId)) {
        isCorrectId = true;
      }
      else {
        isCorrectId = false;
        document.getElementById("alert-message").innerText = "Wrong Username or password!"
      }
    } else {
      document.getElementById("alert-message").innerText = "Please enter your Username and Password!"
    }
    console.log('UserName = ' + isCorrectId);
  };


  const checkUserPw = () => {
    getUserPw = document.getElementById("user-pw").value;  //get user pw input
    if (getUserPw !== '') {                             //check user input not empty
      if (getUserPw === validUserData[getUserId].pw) {
        isCorrectPw = true;
      }
      else {
        isCorrectPw = false;
        document.getElementById("alert-message").innerText = "Wrong Username or password!"
      }
    }
    else {
      document.getElementById("alert-message").innerText = "Please enter your Username and Password!"
    }
    console.log('PW = ' + isCorrectPw);
  };

  function redirectPage(form) {       //redirect to another page if user_ID & Password both correct
    if (isCorrectId && isCorrectPw) {
      passUserName();
      form.action = "./index.html";
      console.log(form.action);
      return false;
    }
    else{
      event.preventDefault(); //prevent refresh page after submit form
      console.log("Not redirecting")
    }
  };

  const passUserName = () => {        //pass user name value to another page
    localStorage.setItem("username", validUserData[getUserId].name);
    console.log("Value Passed");
    return false;
  };
</script>

</html>